<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>Document</title>
</head>

<body>
  <div class="card-box neumorphism">
    <div id="gameMode">

      <label>新手：<input type="checkbox" name="isBeginner" /></label>
      <label>选区：<input type="checkbox" name="isRandomServer" /></label>



      <label>主线<input type="radio" name="gameMode" value="mainStory" checked="true" /></label>

      <label>副本<input type="radio" name="gameMode" value="instance" /></label>

      <label>委托<input type="radio" name="gameMode" value="delegate" /></label>


    </div>
  </div>
  <div class="card-box neumorphism">
    <div id="normal-instanceZone" class="select-menu">
      <div class="select neumorphism">
        <span>普通副本：</span>
        <div class="arrow-box">
          <img class="arrow" src="../img/svg/down_arrow.svg" alt="选择" />
          <img class="arrow arrow-hidden" src="../img/svg/up_arrow.svg" alt="选择" />
        </div>
      </div>
      <div class="option-list">
        <div class="option">
          <label><input type="checkbox" />远古迷宫</label>
          <div class="level-select-menu">
            <div class="level-select neumorphism">等级</div>
            <div class="level-option-list ">
              <div class="level-option">1级</div>
              <div class="level-option">44级</div>
              <div class="level-option">62级</div>
            </div>
          </div>
        </div>
        <div class="option">
          <label><input type="checkbox" />地下墓穴</label>
          <div class="level-select-menu">
            <div class="level-select neumorphism">等级</div>
            <div class="level-option-list ">
              <div class="level-option">28级</div>
              <div class="level-option">47级</div>
              <div class="level-option">62级</div>
            </div>
          </div>
        </div>
        <div class="option">
          <label><input type="checkbox" />迪贝格</label>
          <div class="level-select-menu">
            <div class="level-select neumorphism">等级</div>
            <div class="level-option-list ">
              <div class="level-option">50级</div>
              <div class="level-option">67级</div>
              <div class="level-option">75级</div>
            </div>
          </div>
        </div>
        <div class="option">
          <label><input type="checkbox" />沙漠洞穴</label>
          <div class="level-select-menu">
            <div class="level-select neumorphism">等级</div>
            <div class="level-option-list ">
              <div class="level-option">67级</div>
              <div class="level-option">79级</div>
            </div>
          </div>
        </div>
        <div class="option">
          <label><input type="checkbox" />地下神殿</label>
        </div>
      </div>
    </div>

    <div id="special-instanceZone">
      <div class="select-menu">
        <div class="select neumorphism">
          <span>特殊副本：</span>
          <div class="arrow-box">
            <img class="arrow" src="../img/svg/down_arrow.svg" alt="选择" />
            <img class="arrow arrow-hidden" src="../img/svg/up_arrow.svg" alt="选择" />
          </div>
        </div>
        <div class="option-list">
          <div class="option"><label><input type="checkbox" /><span>精灵矿山</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>幻影遗迹</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>时间迷宫</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>寒冰神殿</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>混沌城堡</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>精灵城堡</span></label>
          </div>
        </div>
      </div>
      <div>
        副本挂机总时间：<span id="time">0</span>小时
      </div>
    </div>

  </div>
  <div>
    <a href="http:10.6.130.129:82/archer.png" download>更新脚本</a>
    <button id="startBtn" class="neumorphism">Start</button>
  </div>
  <script>
    const ui = {
      gameMode: "mainStory",
      isBeginner: false,
      isRandomServer: false,
      instanceQueue: [],
    };
    const selects = document.querySelectorAll(".select-menu");

    const normalZone = document.querySelectorAll("#normal-instanceZone .option input[type=checkbox]");
    const levelSelectMenu = document.querySelectorAll(".level-select-menu");
    const specialZone = document.querySelectorAll("#special-instanceZone .option input[type=checkbox]");
    const startBtn = document.querySelector("#startBtn");
    const beginnerCheckBox = document.querySelector("input[name=isBeginner]");
    const randomServerCheckBox = document.querySelector("input[name=isRandomServer]");
    const time = document.querySelector("#time");

    levelSelectMenu.forEach((menu) =>
    {
      let levelSelect = menu.querySelector(".level-select");
      let levelOptionList = menu.querySelector(".level-option-list");
      levelSelect.addEventListener("click", () =>
      {
        levelOptionList.classList.toggle("level-selected");
        levelOptionList.querySelectorAll(".level-option").forEach(option =>
        {
          option.addEventListener("click", () =>
          {
            levelSelect.innerHTML = option.innerHTML;
            levelOptionList.classList.toggle("level-selected");
          });
        });
        console.log("click");
      });
    });
    //单选框点击事件
    document.querySelectorAll("input[name= gameMode]").forEach((radio) =>
    {
      radio.addEventListener("click", () =>
      {
        ui.gameMode = radio.value;
      });
    });

    //新手复选框
    beginnerCheckBox.addEventListener("click", () =>
    {
      ui.isBeginner = beginnerCheckBox.checked;
    });
    randomServerCheckBox.addEventListener("click", () =>
    {
      ui.isRandomServer = randomServerCheckBox.checked;
    });
    //副本选项
    normalZone.forEach((checkbox, index) =>
    {
      checkbox.addEventListener("click", () =>
      {
        if (checkbox.checked)
        {
          ui.instanceQueue.push({ type: "normal", index: index, level: "firstLevel" });
        }
        else
        {
          ui.instanceQueue = ui.instanceQueue.filter((obj) => obj.index != index);
        }
      });
    });
    specialZone.forEach((checkbox, index) =>
    {
      checkbox.addEventListener("click", () =>
      {
        if (checkbox.checked)
        {
          ui.instanceQueue.push({ type: "special", index: index, level: "firstLevel" });
        }
        else
        {
          ui.instanceQueue = ui.instanceQueue.filter((obj) => obj.index != index);
        }
      });
    });
    //下拉菜单显示与隐藏
    selects.forEach((select) =>
    {
      select.querySelector(".select").addEventListener("click", () =>
      {
        select.querySelector(".option-list").classList.toggle("active");
        select
          .querySelectorAll(".arrow")
          .forEach((arrow) => arrow.classList.toggle("arrow-hidden"));
      });
    });


    //选项的点击事件

    //开始按钮点击事件
    startBtn.addEventListener("click", () =>
    {
      $autox.callHandler("WebToAndroid", JSON.stringify(ui), (callBackData) =>
      {
        startBtn.innerHTML = "Stop";
        startBtn.style.cssText = "background: red";
        console.log(callBackData);
      });

    });
    // $autox.registerHandler("AndroidToWeb", (data, callBack) =>
    // {
    //   time.innerText = data;
    //   console.log("time:" + JSON.parse(data));
    //   setTimeout(() =>
    //   {
    //     //回调安卓
    //     callBack("web回调数据");
    //   }, 1000);
    // });
    document.addEventListener("AutoxJsBridgeReady", () =>
    {
      //$autox.
      console.log("AutoxJsBridegReady");
    });
  </script>
</body>

</html>