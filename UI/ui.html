<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>Document</title>
</head>

<body>
  <div class="card-box neumorphism">
    <div id="gameMode">
      <label>新手：<input type="checkbox" name="isBeginner" /></label>
      <div>
        <label>主线<input type="radio" name="gameMode" value="mainStory" checked="true" /></label>

        <label>副本<input type="radio" name="gameMode" value="instance" /></label>

        <label>委托<input type="radio" name="gameMode" value="delegate" /></label>
      </div>

    </div>
  </div>
  <div class="card-box neumorphism">
    <div id="normal-instanceZone" class="select-menu">
      <div class="select neumorphism">
        <span>普通副本：</span>
        <div class="arrow-box">
          <img class="arrow" src="../img/svg/down_arrow.svg" alt="选择" />
          <img class="arrow arrow-hidden" src="../img/svg/up_arrow.svg" alt="选择" />
        </div>
      </div>
      <div class="option-list">
        <div class="option"><label><input type="checkbox" />远古迷宫</label>
          <div><button class="plus neumorphism">+</button><span>1</span><button class="subtract neumorphism">-</button>
          </div>
          <div><span>1</span>级</div>
        </div>
        <div class="option"><label><input type="checkbox" />地下墓穴</label>
          <div><button class="plus neumorphism">+</button><span>1</span><button class="subtract neumorphism">-</button>
          </div>
          <div><span>28</span>级</div>
        </div>
        <div class="option"><label><input type="checkbox" />迪贝格</label>
          <div><button class="plus neumorphism">+</button><span>1</span><button class="subtract neumorphism">-</button>
          </div>
          <div><span>50</span>级</div>
        </div>
        <div class="option"><label><input type="checkbox" />沙漠洞穴</label>
          <div><button class="plus neumorphism">+</button><span>1</span><button class="subtract neumorphism">-</button>
          </div>
          <div><span>67</span>级</div>
        </div>
        <div class="option"><label><input type="checkbox" />地下神殿</label>
          <div><button class="plus neumorphism">+</button><span>1</span><button class="subtract neumorphism">-</button>
          </div>
          <div>无</div>
        </div>
      </div>
    </div>

    <div id="special-instanceZone">
      <div class="select-menu">
        <div class="select neumorphism">
          <span>特殊副本：</span>
          <div class="arrow-box">
            <img class="arrow" src="../img/svg/down_arrow.svg" alt="选择" />
            <img class="arrow arrow-hidden" src="../img/svg/up_arrow.svg" alt="选择" />
          </div>
        </div>
        <div class="option-list">
          <div class="option"><label><input type="checkbox" /><span>精灵矿山</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>幻影遗迹</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>时间迷宫</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>寒冰神殿</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>混沌城堡</span></label>
          </div>
          <div class="option"><label><input type="checkbox" /><span>精灵城堡</span></label>
          </div>
        </div>
      </div>
      <div>
        副本挂机总时间：<span id="time">0</span>小时
      </div>
    </div>


  </div>
  <div>
    <button id="startBtn" class="neumorphism">Start</button>
  </div>
  <script>
    const ui = {
      gameMode: "mainStory",
      isBeginner: false,
      normalZone: [
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
      ],
      specialZone: [
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
        { checked: false, time: 1, level: "firstLevel" },
      ]
    };
    const selects = document.querySelectorAll(".select-menu");
    const normalOption = document.querySelectorAll("#normal-instanceZone .option");
    const specialOption = document.querySelectorAll("#special-instanceZone .option");
    // const zoneCheckBoxes = document.querySelectorAll(".option input[type=checkbox]");
    const startBtn = document.querySelector("#startBtn");
    const beginnerCheckBox = document.querySelector("input[name=isBeginner]");
    const time = document.querySelector("#time");

    // zoneCheckBoxes.forEach((checkbox) =>
    // {
    //   checkbox.addEventListener("click", () =>
    //   {
    //     GetTotalTime();
    //   });
    // });
    function GetTotalTime()
    {
      let totalTime = 0;
      ui.normalZone.forEach((zone) =>
      {
        if (zone.checked)
        {
          totalTime += zone.time;
        }
      });
      ui.specialZone.forEach((zone) =>
      {
        if (zone.checked)
        {
          totalTime += zone.time;
        }
      });
      time.innerText = totalTime;
    }

    //单选框点击事件
    document.querySelectorAll("input[name= gameMode]").forEach((radio) =>
    {
      radio.addEventListener("click", () =>
      {
        ui.gameMode = radio.value;
      });
    });
    //新手复选框
    beginnerCheckBox.addEventListener("click", () =>
    {
      ui.isBeginner = beginnerCheckBox.checked;
    });
    //下拉菜单显示与隐藏
    selects.forEach((select) =>
    {
      select.querySelector(".select").addEventListener("click", () =>
      {
        select.querySelector(".option-list").classList.toggle("active");
        select
          .querySelectorAll(".arrow")
          .forEach((arrow) => arrow.classList.toggle("arrow-hidden"));
      });
    });


    //选项的点击事件
    normalOption.forEach((option, index) =>
    {
      let time = option.querySelector("span:first-of-type");
      let input = option.querySelector("input");
      input.addEventListener("click", () =>
      {
        ui.normalZone[index].checked = input.checked;
        console.log(ui.normalZone[index]);
        GetTotalTime();
      });
      let plus = option.querySelector(".plus");
      plus.addEventListener("click", () =>
      {
        let addTime = parseInt(time.innerText);
        addTime++;
        time.innerText = addTime;
        ui.normalZone[index].time = addTime;
        GetTotalTime();
      });
      let subtract = option.querySelector(".subtract");
      subtract.addEventListener("click", () =>
      {
        let subTime = parseInt(time.innerText);
        if (subTime == 1)
        {
          subTime = 1;
        }
        else subTime--;
        time.innerText = subTime;
        ui.normalZone[index].time = subTime;
        GetTotalTime();
      });

    });

    specialOption.forEach((option, index) =>
    {
      let input = option.querySelector("input");
      input.addEventListener("click", () =>
      {
        ui.specialZone[index].checked = input.checked;
        console.log(ui.specialZone[index]);
        GetTotalTime();
      });
    });

    //开始按钮点击事件
    startBtn.addEventListener("click", () =>
    {
      $autox.callHandler("WebToAndroid", JSON.stringify(ui), (callBackData) =>
      {
        startBtn.innerHTML = "Stop";
        startBtn.style.cssText = "background: red";
        console.log(callBackData);
      });

    });
    // $autox.registerHandler("AndroidToWeb", (data, callBack) =>
    // {
    //   time.innerText = data;
    //   console.log("time:" + JSON.parse(data));
    //   setTimeout(() =>
    //   {
    //     //回调安卓
    //     callBack("web回调数据");
    //   }, 1000);
    // });
    document.addEventListener("AutoxJsBridgeReady", () =>
    {
      //$autox.
      console.log("AutoxJsBridegReady");
    });
  </script>
</body>

</html>